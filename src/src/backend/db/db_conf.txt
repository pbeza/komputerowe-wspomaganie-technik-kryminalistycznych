Notatki z konfiguracji PostgreSQL
---------------------------------

Dane do logowania do bazy danych:

login: eigenuser
pass: eigenfaces

---

Sposób logowania do bazy danych:

psql -h localhost -d template1 -U eigenuser -W

---
 
Konfiguracja/dodawanie kont użytkowników bazy danych PostgreSQL:

su -
su - postgres
createuser eigenuser
psql -d template1
alter user eigenuser password 'eigenfaces';

$ su - postgres
$ psql template1
template1=# CREATE USER tester WITH PASSWORD 'test_password';
template1=# GRANT ALL PRIVILEGES ON DATABASE "test_database" to tester;
template1=# \q

\du - wyświetla role
\d+ - wyświetla tabele

---

Sposób tworzenia tabeli z twarzami:

CREATE TABLE faces (
  id        SERIAL            NOT NULL,
  person_id INT               NOT NULL,
  image_id  INT               NOT NULL,
  image     BYTEA             NOT NULL,
  filename  VARCHAR   UNIQUE  NOT NULL,
  filetype  CHAR(16)          NOT NULL,
  timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,
  PRIMARY KEY (id)
);

COMMENT ON TABLE faces is 'Stores images of the people that PCA identification algorithm works with during its training';
COMMENT ON COLUMN faces.person_id IS 'Unique person ID';
COMMENT ON COLUMN faces.image_id IS 'Unique photo ID within photos of single person';
COMMENT ON COLUMN faces.image IS 'Photo of the person (every photo MUST HAVE the same size)';
COMMENT ON COLUMN faces.filename IS 'Filename of the photo';
COMMENT ON COLUMN faces.filetype IS 'Filetype of the photo';
COMMENT ON COLUMN faces.timestamp IS 'Automatically filled time and date when new record was added';

---

Przyznanie uprawnień:

GRANT select, insert, update, delete ON faces TO eigenuser;
GRANT ALL PRIVILEGES ON DATABASE "template1" TO eigenuser;
GRANT USAGE, SELECT ON SEQUENCE faces_id_seq TO eigenuser;

---

Przywrócenie bazy danych z pliku:

psql template1 < template1_db_postgresql.dump

Zrzut bazy danych do pliku:

pg_dump dbname > outfile

Więcej info:

https://www.postgresql.org/docs/current/static/backup-dump.html

---

Aby zacząć automatyczną numerację kolumny ID od 0:

ALTER SEQUENCE faces_id_seq RESTART WITH 0;

nie jest to w ogóle potrzebne, ale będzie ładniej jak będzie numeracja od 0.